def TEST = UnitTest.new("Float", test);

def test() {
	test_f32s();
	test_f32u();
	test_f64s();
	test_f64u();
}

def tryPromoteS_F32 = Float.FLOAT32.tryPromoteS;
def tryPromoteU_F32 = Float.FLOAT32.tryPromoteU(0, _);
def tryPromoteS_F64 = Float.FLOAT64.tryPromoteS;
def tryPromoteU_F64 = Float.FLOAT64.tryPromoteU(0, _);

def test_l_fn(i: long) {  // long -> float, expecting null
	var v = tryPromoteS_F32(i);
	if (v != null) {
		var got = Float32Val.!(v).bits;
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected null, got ", i);
		buf.putx(int.!(got));
		TEST.error(buf.toString());
	}
}
def test_l_fv(i: long, expected: u32) { // long -> float, expecting value
	var v = tryPromoteS_F32(i);
	if (v == null) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(int.!(expected));
		buf.puts(", got null");
		TEST.error(buf.toString());
		return;
	}
	var got = Float32Val.!(v).bits;
	if (expected != got) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(int.!(expected));
		buf.puts(", got ");
		buf.putx(int.!(got));
		TEST.error(buf.toString());
		return;
	}
}

def test_u_fn(i: u64) {  // long -> float, expecting null
	var v = tryPromoteU_F32(i);
	if (v != null) {
		var got = Float32Val.!(v).bits;
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected null, got ", i);
		buf.putx(int.!(got));
		TEST.error(buf.toString());
	}
}
def test_u_fv(i: u64, expected: u32) { // long -> float, expecting value
	var v = tryPromoteU_F32(i);
	if (v == null) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(int.!(expected));
		buf.puts(", got null");
		TEST.error(buf.toString());
		return;
	}
	var got = Float32Val.!(v).bits;
	if (expected != got) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(int.!(expected));
		buf.puts(", got ");
		buf.putx(int.!(got));
		TEST.error(buf.toString());
		return;
	}
}

def test_f32s() {
	test_l_fv(0, 0x0);
	test_l_fv(1, 0x3f800000);
	test_l_fv(2, 0x40000000);
	test_l_fv(3, 0x40400000);
	test_l_fv(4, 0x40800000);
	test_l_fv(10, 0x41200000);
	test_l_fv(11, 0x41300000);
	test_l_fv(12, 0x41400000);
	test_l_fv(13, 0x41500000);
	test_l_fv(14, 0x41600000);
	test_l_fv(30, 0x41f00000);
	test_l_fv(31, 0x41f80000);
	test_l_fv(32, 0x42000000);
	test_l_fv(33, 0x42040000);
	test_l_fv(34, 0x42080000);
	test_l_fv(70, 0x428c0000);
	test_l_fv(71, 0x428e0000);
	test_l_fv(72, 0x42900000);
	test_l_fv(73, 0x42920000);
	test_l_fv(74, 0x42940000);
	test_l_fv(150, 0x43160000);
	test_l_fv(151, 0x43170000);
	test_l_fv(152, 0x43180000);
	test_l_fv(153, 0x43190000);
	test_l_fv(154, 0x431a0000);
	test_l_fv(310, 0x439b0000);
	test_l_fv(311, 0x439b8000);
	test_l_fv(312, 0x439c0000);
	test_l_fv(313, 0x439c8000);
	test_l_fv(314, 0x439d0000);
	test_l_fv(630, 0x441d8000);
	test_l_fv(631, 0x441dc000);
	test_l_fv(632, 0x441e0000);
	test_l_fv(633, 0x441e4000);
	test_l_fv(634, 0x441e8000);
	test_l_fv(1270, 0x449ec000);
	test_l_fv(1271, 0x449ee000);
	test_l_fv(1272, 0x449f0000);
	test_l_fv(1273, 0x449f2000);
	test_l_fv(1274, 0x449f4000);
	test_l_fv(2550, 0x451f6000);
	test_l_fv(2551, 0x451f7000);
	test_l_fv(2552, 0x451f8000);
	test_l_fv(2553, 0x451f9000);
	test_l_fv(2554, 0x451fa000);
	test_l_fv(5110, 0x459fb000);
	test_l_fv(5111, 0x459fb800);
	test_l_fv(5112, 0x459fc000);
	test_l_fv(5113, 0x459fc800);
	test_l_fv(5114, 0x459fd000);
	test_l_fv(10230, 0x461fd800);
	test_l_fv(10231, 0x461fdc00);
	test_l_fv(10232, 0x461fe000);
	test_l_fv(10233, 0x461fe400);
	test_l_fv(10234, 0x461fe800);
	test_l_fv(20470, 0x469fec00);
	test_l_fv(20471, 0x469fee00);
	test_l_fv(20472, 0x469ff000);
	test_l_fv(20473, 0x469ff200);
	test_l_fv(20474, 0x469ff400);
	test_l_fv(40950, 0x471ff600);
	test_l_fv(40951, 0x471ff700);
	test_l_fv(40952, 0x471ff800);
	test_l_fv(40953, 0x471ff900);
	test_l_fv(40954, 0x471ffa00);
	test_l_fv(81910, 0x479ffb00);
	test_l_fv(81911, 0x479ffb80);
	test_l_fv(81912, 0x479ffc00);
	test_l_fv(81913, 0x479ffc80);
	test_l_fv(81914, 0x479ffd00);
	test_l_fv(163830, 0x481ffd80);
	test_l_fv(163831, 0x481ffdc0);
	test_l_fv(163832, 0x481ffe00);
	test_l_fv(163833, 0x481ffe40);
	test_l_fv(163834, 0x481ffe80);
	test_l_fv(327670, 0x489ffec0);
	test_l_fv(327671, 0x489ffee0);
	test_l_fv(327672, 0x489fff00);
	test_l_fv(327673, 0x489fff20);
	test_l_fv(327674, 0x489fff40);
	test_l_fv(655350, 0x491fff60);
	test_l_fv(655351, 0x491fff70);
	test_l_fv(655352, 0x491fff80);
	test_l_fv(655353, 0x491fff90);
	test_l_fv(655354, 0x491fffa0);
	test_l_fv(1310710, 0x499fffb0);
	test_l_fv(1310711, 0x499fffb8);
	test_l_fv(1310712, 0x499fffc0);
	test_l_fv(1310713, 0x499fffc8);
	test_l_fv(1310714, 0x499fffd0);
	test_l_fv(2621430, 0x4a1fffd8);
	test_l_fv(2621431, 0x4a1fffdc);
	test_l_fv(2621432, 0x4a1fffe0);
	test_l_fv(2621433, 0x4a1fffe4);
	test_l_fv(2621434, 0x4a1fffe8);
	test_l_fv(5242870, 0x4a9fffec);
	test_l_fv(5242871, 0x4a9fffee);
	test_l_fv(5242872, 0x4a9ffff0);
	test_l_fv(5242873, 0x4a9ffff2);
	test_l_fv(5242874, 0x4a9ffff4);
	test_l_fv(10485750, 0x4b1ffff6);
	test_l_fv(10485751, 0x4b1ffff7);
	test_l_fv(10485752, 0x4b1ffff8);
	test_l_fv(10485753, 0x4b1ffff9);
	test_l_fv(10485754, 0x4b1ffffa);
	test_l_fv(20971510, 0x4b9ffffb);
	test_l_fn(20971511);
	test_l_fv(20971512, 0x4b9ffffc);
	test_l_fn(20971513);
	test_l_fv(20971514, 0x4b9ffffd);
	test_l_fn(41943030);
	test_l_fn(41943031);
	test_l_fv(41943032, 0x4c1ffffe);
	test_l_fn(41943033);
	test_l_fn(41943034);
	test_l_fn(83886070);
	test_l_fn(83886071);
	test_l_fv(83886072, 0x4c9fffff);
	test_l_fn(83886073);
	test_l_fn(83886074);
	test_l_fn(167772150);
	test_l_fn(167772151);
	test_l_fn(335544310);
	test_l_fn(335544311);
	test_l_fn(671088630);
	test_l_fn(671088631);
	test_l_fn(671088632);
	test_l_fn(1342177270);
	test_l_fn(1342177271);
	test_l_fn(2684354550);
	test_l_fn(2684354554);
	test_l_fn(5368709110);
	test_l_fn(5368709114);
	test_l_fn(10737418230);
	test_l_fn(10737418234);
	test_l_fn(21474836470);
	test_l_fn(21474836474);
	test_l_fn(42949672950);
	test_l_fn(42949672954);
	test_l_fn(85899345910);
	test_l_fn(85899345914);
	test_l_fn(171798691830);
	test_l_fn(171798691834);
	test_l_fn(343597383670);
	test_l_fn(343597383674);
	test_l_fn(687194767350);
	test_l_fn(687194767354);
	test_l_fn(1374389534710);
	test_l_fn(1374389534714);
	test_l_fn(2748779069430);
	test_l_fn(2748779069434);
	test_l_fn(5497558138870);
	test_l_fn(5497558138874);
	test_l_fn(10995116277750);
	test_l_fn(10995116277754);
	test_l_fn(21990232555510);
	test_l_fn(21990232555514);
	test_l_fn(43980465111030);
	test_l_fn(43980465111034);
	test_l_fn(87960930222070);
	test_l_fn(87960930222074);
	test_l_fn(175921860444150);
	test_l_fn(175921860444154);
	test_l_fn(351843720888310);
	test_l_fn(351843720888314);
	test_l_fn(703687441776630);
	test_l_fn(703687441776634);
	test_l_fn(1407374883553270);
	test_l_fn(1407374883553274);
	test_l_fn(2814749767106550);
	test_l_fn(2814749767106554);
	test_l_fn(5629499534213110);
	test_l_fn(5629499534213114);
	test_l_fn(11258999068426230);
	test_l_fn(11258999068426234);
	test_l_fn(22517998136852470);
	test_l_fn(22517998136852474);
	test_l_fn(45035996273704950);
	test_l_fn(45035996273704954);
	test_l_fn(90071992547409910);
	test_l_fn(90071992547409914);
	test_l_fn(180143985094819830);
	test_l_fn(180143985094819834);
	test_l_fn(360287970189639670);
	test_l_fn(360287970189639674);
	test_l_fn(720575940379279350);
	test_l_fn(720575940379279354);
	test_l_fn(1441151880758558710);
	test_l_fn(1441151880758558714);
	test_l_fn(2882303761517117430);
	test_l_fn(2882303761517117434);
	test_l_fn(5764607523034234870);
	test_l_fn(5764607523034234874);
	test_l_fn(-6917529027641081866);
	test_l_fn(-6917529027641081862);
	test_l_fn(4611686018427387894);
	test_l_fn(4611686018427387898);
	test_l_fn(9223372036854775798);
	test_l_fn(9223372036854775802);

	test_l_fv(-10, 0xc1200000);
	test_l_fv(-9, 0xc1100000);
	test_l_fv(-8, 0xc1000000);
	test_l_fv(-7, 0xc0e00000);
	test_l_fv(-6, 0xc0c00000);
	test_l_fv(-1, 0xbf800000);
	test_l_fv(-2, 0xc0000000);
	test_l_fv(-3, 0xc0400000);
	test_l_fv(-4, 0xc0800000);
	test_l_fv(-10, 0xc1200000);
	test_l_fv(-11, 0xc1300000);
	test_l_fv(-12, 0xc1400000);
	test_l_fv(-13, 0xc1500000);
	test_l_fv(-14, 0xc1600000);
	test_l_fv(-30, 0xc1f00000);
	test_l_fv(-31, 0xc1f80000);
	test_l_fv(-32, 0xc2000000);
	test_l_fv(-33, 0xc2040000);
	test_l_fv(-34, 0xc2080000);
	test_l_fv(-70, 0xc28c0000);
	test_l_fv(-71, 0xc28e0000);
	test_l_fv(-72, 0xc2900000);
	test_l_fv(-73, 0xc2920000);
	test_l_fv(-74, 0xc2940000);
	test_l_fv(-150, 0xc3160000);
	test_l_fv(-151, 0xc3170000);
	test_l_fv(-152, 0xc3180000);
	test_l_fv(-153, 0xc3190000);
	test_l_fv(-154, 0xc31a0000);
	test_l_fv(-310, 0xc39b0000);
	test_l_fv(-311, 0xc39b8000);
	test_l_fv(-312, 0xc39c0000);
	test_l_fv(-313, 0xc39c8000);
	test_l_fv(-314, 0xc39d0000);
	test_l_fv(-630, 0xc41d8000);
	test_l_fv(-631, 0xc41dc000);
	test_l_fv(-632, 0xc41e0000);
	test_l_fv(-633, 0xc41e4000);
	test_l_fv(-634, 0xc41e8000);
	test_l_fv(-1270, 0xc49ec000);
	test_l_fv(-1271, 0xc49ee000);
	test_l_fv(-1272, 0xc49f0000);
	test_l_fv(-1273, 0xc49f2000);
	test_l_fv(-1274, 0xc49f4000);
	test_l_fv(-2550, 0xc51f6000);
	test_l_fv(-2551, 0xc51f7000);
	test_l_fv(-2552, 0xc51f8000);
	test_l_fv(-2553, 0xc51f9000);
	test_l_fv(-2554, 0xc51fa000);
	test_l_fv(-5110, 0xc59fb000);
	test_l_fv(-5111, 0xc59fb800);
	test_l_fv(-5112, 0xc59fc000);
	test_l_fv(-5113, 0xc59fc800);
	test_l_fv(-5114, 0xc59fd000);
	test_l_fv(-10230, 0xc61fd800);
	test_l_fv(-10231, 0xc61fdc00);
	test_l_fv(-10232, 0xc61fe000);
	test_l_fv(-10233, 0xc61fe400);
	test_l_fv(-10234, 0xc61fe800);
	test_l_fv(-20470, 0xc69fec00);
	test_l_fv(-20471, 0xc69fee00);
	test_l_fv(-20472, 0xc69ff000);
	test_l_fv(-20473, 0xc69ff200);
	test_l_fv(-20474, 0xc69ff400);
	test_l_fv(-40950, 0xc71ff600);
	test_l_fv(-40951, 0xc71ff700);
	test_l_fv(-40952, 0xc71ff800);
	test_l_fv(-40953, 0xc71ff900);
	test_l_fv(-40954, 0xc71ffa00);
	test_l_fv(-81910, 0xc79ffb00);
	test_l_fv(-81911, 0xc79ffb80);
	test_l_fv(-81912, 0xc79ffc00);
	test_l_fv(-81913, 0xc79ffc80);
	test_l_fv(-81914, 0xc79ffd00);
	test_l_fv(-163830, 0xc81ffd80);
	test_l_fv(-163831, 0xc81ffdc0);
	test_l_fv(-163832, 0xc81ffe00);
	test_l_fv(-163833, 0xc81ffe40);
	test_l_fv(-163834, 0xc81ffe80);
	test_l_fv(-327670, 0xc89ffec0);
	test_l_fv(-327671, 0xc89ffee0);
	test_l_fv(-327672, 0xc89fff00);
	test_l_fv(-327673, 0xc89fff20);
	test_l_fv(-327674, 0xc89fff40);
	test_l_fv(-655350, 0xc91fff60);
	test_l_fv(-655351, 0xc91fff70);
	test_l_fv(-655352, 0xc91fff80);
	test_l_fv(-655353, 0xc91fff90);
	test_l_fv(-655354, 0xc91fffa0);
	test_l_fv(-1310710, 0xc99fffb0);
	test_l_fv(-1310711, 0xc99fffb8);
	test_l_fv(-1310712, 0xc99fffc0);
	test_l_fv(-1310713, 0xc99fffc8);
	test_l_fv(-1310714, 0xc99fffd0);
	test_l_fv(-2621430, 0xca1fffd8);
	test_l_fv(-2621431, 0xca1fffdc);
	test_l_fv(-2621432, 0xca1fffe0);
	test_l_fv(-2621433, 0xca1fffe4);
	test_l_fv(-2621434, 0xca1fffe8);
	test_l_fv(-5242870, 0xca9fffec);
	test_l_fv(-5242871, 0xca9fffee);
	test_l_fv(-5242872, 0xca9ffff0);
	test_l_fv(-5242873, 0xca9ffff2);
	test_l_fv(-5242874, 0xca9ffff4);
	test_l_fv(-10485750, 0xcb1ffff6);
	test_l_fv(-10485751, 0xcb1ffff7);
	test_l_fv(-10485752, 0xcb1ffff8);
	test_l_fv(-10485753, 0xcb1ffff9);
	test_l_fv(-10485754, 0xcb1ffffa);
	test_l_fv(-20971510, 0xcb9ffffb);
	test_l_fn(-20971511);
	test_l_fv(-20971512, 0xcb9ffffc);
	test_l_fn(-20971513);
	test_l_fv(-20971514, 0xcb9ffffd);
	test_l_fn(-41943030);
	test_l_fn(-41943031);
	test_l_fv(-41943032, 0xcc1ffffe);
	test_l_fn(-41943033);
	test_l_fn(-41943034);
	test_l_fn(-83886070);
	test_l_fn(-83886071);
	test_l_fv(-83886072, 0xcc9fffff);
	test_l_fn(-83886073);
	test_l_fn(-83886074);
	test_l_fn(-167772150);
	test_l_fn(-167772154);
	test_l_fn(-335544310);
	test_l_fn(-335544314);
	test_l_fn(-671088630);
	test_l_fn(-671088634);
	test_l_fn(-1342177270);
	test_l_fn(-1342177274);
	test_l_fn(-2684354550);
	test_l_fn(-2684354554);
	test_l_fn(-5368709110);
	test_l_fn(-5368709114);
	test_l_fn(-10737418230);
	test_l_fn(-10737418234);
	test_l_fn(-21474836470);
	test_l_fn(-21474836474);
	test_l_fn(-42949672950);
	test_l_fn(-42949672954);
	test_l_fn(-85899345910);
	test_l_fn(-85899345914);
	test_l_fn(-171798691830);
	test_l_fn(-171798691834);
	test_l_fn(-343597383670);
	test_l_fn(-343597383674);
	test_l_fn(-687194767350);
	test_l_fn(-687194767354);
	test_l_fn(-1374389534710);
	test_l_fn(-1374389534714);
	test_l_fn(-2748779069430);
	test_l_fn(-2748779069434);
	test_l_fn(-5497558138870);
	test_l_fn(-5497558138874);
	test_l_fn(-10995116277750);
	test_l_fn(-10995116277754);
	test_l_fn(-21990232555510);
	test_l_fn(-21990232555514);
	test_l_fn(-43980465111030);
	test_l_fn(-43980465111034);
	test_l_fn(-87960930222070);
	test_l_fn(-87960930222074);
	test_l_fn(-175921860444150);
	test_l_fn(-175921860444154);
	test_l_fn(-351843720888310);
	test_l_fn(-351843720888314);
	test_l_fn(-703687441776630);
	test_l_fn(-703687441776634);
	test_l_fn(-1407374883553270);
	test_l_fn(-1407374883553274);
	test_l_fn(-2814749767106550);
	test_l_fn(-2814749767106554);
	test_l_fn(-5629499534213110);
	test_l_fn(-5629499534213114);
	test_l_fn(-11258999068426230);
	test_l_fn(-11258999068426234);
	test_l_fn(-22517998136852470);
	test_l_fn(-22517998136852474);
	test_l_fn(-45035996273704950);
	test_l_fn(-45035996273704954);
	test_l_fn(-90071992547409910);
	test_l_fn(-90071992547409914);
	test_l_fn(-180143985094819830);
	test_l_fn(-180143985094819834);
	test_l_fn(-360287970189639670);
	test_l_fn(-360287970189639674);
	test_l_fn(-720575940379279350);
	test_l_fn(-720575940379279354);
	test_l_fn(-1441151880758558710);
	test_l_fn(-1441151880758558714);
	test_l_fn(-2882303761517117430);
	test_l_fn(-2882303761517117434);
	test_l_fn(-5764607523034234870);
	test_l_fn(-5764607523034234874);
	test_l_fn(6917529027641081866);
	test_l_fn(6917529027641081862);
	test_l_fn(-4611686018427387894);
	test_l_fn(-4611686018427387898);
	test_l_fn(-9223372036854775798);
	test_l_fn(-9223372036854775802);

	test_l_fv(-85893054464, 0xd19ffd00);
	test_l_fv(-171788206080, 0xd21ffd80);
	test_l_fv(-171789254656, 0xd21ffdc0);
	test_l_fv(-171790303232, 0xd21ffe00);
	test_l_fv(-171791351808, 0xd21ffe40);
	test_l_fv(-171792400384, 0xd21ffe80);
	test_l_fv(-343586897920, 0xd29ffec0);
	test_l_fv(-343587946496, 0xd29ffee0);
	test_l_fv(-343588995072, 0xd29fff00);
	test_l_fv(-343590043648, 0xd29fff20);
	test_l_fv(-343591092224, 0xd29fff40);
	test_l_fv(-687184281600, 0xd31fff60);
	test_l_fv(-687185330176, 0xd31fff70);
	test_l_fv(-687186378752, 0xd31fff80);
	test_l_fv(-687187427328, 0xd31fff90);
	test_l_fv(-687188475904, 0xd31fffa0);
	test_l_fv(-1374379048960, 0xd39fffb0);
	test_l_fv(-1374380097536, 0xd39fffb8);
	test_l_fv(-1374381146112, 0xd39fffc0);
	test_l_fv(-1374382194688, 0xd39fffc8);
	test_l_fv(-1374383243264, 0xd39fffd0);
	test_l_fv(-2748768583680, 0xd41fffd8);
	test_l_fv(-2748769632256, 0xd41fffdc);
	test_l_fv(-2748770680832, 0xd41fffe0);
	test_l_fv(-2748771729408, 0xd41fffe4);
	test_l_fv(-2748772777984, 0xd41fffe8);
	test_l_fv(-5497547653120, 0xd49fffec);
	test_l_fv(-5497548701696, 0xd49fffee);
	test_l_fv(-5497549750272, 0xd49ffff0);
	test_l_fv(-5497550798848, 0xd49ffff2);
	test_l_fv(-5497551847424, 0xd49ffff4);
	test_l_fv(-10995105792000, 0xd51ffff6);
	test_l_fv(-10995106840576, 0xd51ffff7);
	test_l_fv(-10995107889152, 0xd51ffff8);
	test_l_fv(-10995108937728, 0xd51ffff9);
	test_l_fv(-10995109986304, 0xd51ffffa);
	test_l_fv(-21990222069760, 0xd59ffffb);
	test_l_fn(-21990223118336);
	test_l_fv(-21990224166912, 0xd59ffffc);
	test_l_fn(-21990225215488);
	test_l_fv(-21990226264064, 0xd59ffffd);
	test_l_fn(-43980454625280);
	test_l_fn(-43980455673856);
	test_l_fv(-43980456722432, 0xd61ffffe);

	test_l_fv(-1441145283688792064, 0xdd9fffd0);
	test_l_fv(-2882292766400839680, 0xde1fffd8);
	test_l_fv(-2882293865912467456, 0xde1fffdc);
	test_l_fv(-2882294965424095232, 0xde1fffe0);
	test_l_fv(-2882296064935723008, 0xde1fffe4);
	test_l_fv(-2882297164447350784, 0xde1fffe8);
	test_l_fv(-5764596527917957120, 0xde9fffec);
	test_l_fv(-5764597627429584896, 0xde9fffee);
	test_l_fv(-5764598726941212672, 0xde9ffff0);
	test_l_fv(-5764599826452840448, 0xde9ffff2);
	test_l_fv(-5764600925964468224, 0xde9ffff4);
	test_l_fv(6917540022757359616, 0x5ec00014);
	test_l_fv(6917538923245731840, 0x5ec00012);
	test_l_fv(6917537823734104064, 0x5ec00010);
	test_l_fv(6917536724222476288, 0x5ec0000e);
	test_l_fv(6917535624710848512, 0x5ec0000c);
	test_l_fv(-4611675023311110144, 0xde7fffd8);
	test_l_fv(-4611676122822737920, 0xde7fffdc);
	test_l_fv(-4611677222334365696, 0xde7fffe0);
	test_l_fv(-4611678321845993472, 0xde7fffe4);
	test_l_fv(-4611679421357621248, 0xde7fffe8);
	test_l_fv(-9223361041738498048, 0xdeffffec);
	test_l_fv(-9223362141250125824, 0xdeffffee);
	test_l_fv(-9223363240761753600, 0xdefffff0);
	test_l_fv(-9223364340273381376, 0xdefffff2);
	test_l_fv(-9223365439785009152, 0xdefffff4);
}

def test_f32u() {
	test_u_fv(0uL, 0x0);
	test_u_fv(1uL, 0x3f800000);
	test_u_fv(2uL, 0x40000000);
	test_u_fv(3uL, 0x40400000);
	test_u_fv(4uL, 0x40800000);
	test_u_fv(10uL, 0x41200000);
	test_u_fv(11uL, 0x41300000);
	test_u_fv(12uL, 0x41400000);
	test_u_fv(13uL, 0x41500000);
	test_u_fv(14uL, 0x41600000);
	test_u_fv(30uL, 0x41f00000);
	test_u_fv(31uL, 0x41f80000);
	test_u_fv(32uL, 0x42000000);
	test_u_fv(33uL, 0x42040000);
	test_u_fv(34uL, 0x42080000);
	test_u_fv(70uL, 0x428c0000);
	test_u_fv(71uL, 0x428e0000);
	test_u_fv(72uL, 0x42900000);
	test_u_fv(73uL, 0x42920000);
	test_u_fv(74uL, 0x42940000);
	test_u_fv(150uL, 0x43160000);
	test_u_fv(151uL, 0x43170000);
	test_u_fv(152uL, 0x43180000);
	test_u_fv(153uL, 0x43190000);
	test_u_fv(154uL, 0x431a0000);
	test_u_fv(310uL, 0x439b0000);
	test_u_fv(311uL, 0x439b8000);
	test_u_fv(312uL, 0x439c0000);
	test_u_fv(313uL, 0x439c8000);
	test_u_fv(314uL, 0x439d0000);
	test_u_fv(630uL, 0x441d8000);
	test_u_fv(631uL, 0x441dc000);
	test_u_fv(632uL, 0x441e0000);
	test_u_fv(633uL, 0x441e4000);
	test_u_fv(634uL, 0x441e8000);
	test_u_fv(1270uL, 0x449ec000);
	test_u_fv(1271uL, 0x449ee000);
	test_u_fv(1272uL, 0x449f0000);
	test_u_fv(1273uL, 0x449f2000);
	test_u_fv(1274uL, 0x449f4000);
	test_u_fv(2550uL, 0x451f6000);
	test_u_fv(2551uL, 0x451f7000);
	test_u_fv(2552uL, 0x451f8000);
	test_u_fv(2553uL, 0x451f9000);
	test_u_fv(2554uL, 0x451fa000);
	test_u_fv(5110uL, 0x459fb000);
	test_u_fv(5111uL, 0x459fb800);
	test_u_fv(5112uL, 0x459fc000);
	test_u_fv(5113uL, 0x459fc800);
	test_u_fv(5114uL, 0x459fd000);
	test_u_fv(10230uL, 0x461fd800);
	test_u_fv(10231uL, 0x461fdc00);
	test_u_fv(10232uL, 0x461fe000);
	test_u_fv(10233uL, 0x461fe400);
	test_u_fv(10234uL, 0x461fe800);
	test_u_fv(20470uL, 0x469fec00);
	test_u_fv(20471uL, 0x469fee00);
	test_u_fv(20472uL, 0x469ff000);
	test_u_fv(20473uL, 0x469ff200);
	test_u_fv(20474uL, 0x469ff400);
	test_u_fv(40950uL, 0x471ff600);
	test_u_fv(40951uL, 0x471ff700);
	test_u_fv(40952uL, 0x471ff800);
	test_u_fv(40953uL, 0x471ff900);
	test_u_fv(40954uL, 0x471ffa00);
	test_u_fv(81910uL, 0x479ffb00);
	test_u_fv(81911uL, 0x479ffb80);
	test_u_fv(81912uL, 0x479ffc00);
	test_u_fv(81913uL, 0x479ffc80);
	test_u_fv(81914uL, 0x479ffd00);
	test_u_fv(163830uL, 0x481ffd80);
	test_u_fv(163831uL, 0x481ffdc0);
	test_u_fv(163832uL, 0x481ffe00);
	test_u_fv(163833uL, 0x481ffe40);
	test_u_fv(163834uL, 0x481ffe80);
	test_u_fv(327670uL, 0x489ffec0);
	test_u_fv(327671uL, 0x489ffee0);
	test_u_fv(327672uL, 0x489fff00);
	test_u_fv(327673uL, 0x489fff20);
	test_u_fv(327674uL, 0x489fff40);
	test_u_fv(655350uL, 0x491fff60);
	test_u_fv(655351uL, 0x491fff70);
	test_u_fv(655352uL, 0x491fff80);
	test_u_fv(655353uL, 0x491fff90);
	test_u_fv(655354uL, 0x491fffa0);
	test_u_fv(1310710uL, 0x499fffb0);
	test_u_fv(1310711uL, 0x499fffb8);
	test_u_fv(1310712uL, 0x499fffc0);
	test_u_fv(1310713uL, 0x499fffc8);
	test_u_fv(1310714uL, 0x499fffd0);
	test_u_fv(2621430uL, 0x4a1fffd8);
	test_u_fv(2621431uL, 0x4a1fffdc);
	test_u_fv(2621432uL, 0x4a1fffe0);
	test_u_fv(2621433uL, 0x4a1fffe4);
	test_u_fv(2621434uL, 0x4a1fffe8);
	test_u_fv(5242870uL, 0x4a9fffec);
	test_u_fv(5242871uL, 0x4a9fffee);
	test_u_fv(5242872uL, 0x4a9ffff0);
	test_u_fv(5242873uL, 0x4a9ffff2);
	test_u_fv(5242874uL, 0x4a9ffff4);
	test_u_fv(10485750uL, 0x4b1ffff6);
	test_u_fv(10485751uL, 0x4b1ffff7);
	test_u_fv(10485752uL, 0x4b1ffff8);
	test_u_fv(10485753uL, 0x4b1ffff9);
	test_u_fv(10485754uL, 0x4b1ffffa);
	test_u_fv(20971510uL, 0x4b9ffffb);
	test_u_fn(20971511uL);
	test_u_fv(20971512uL, 0x4b9ffffc);
	test_u_fn(20971513uL);
	test_u_fv(20971514uL, 0x4b9ffffd);
	test_u_fn(41943030uL);
	test_u_fn(41943031uL);
	test_u_fv(41943032uL, 0x4c1ffffe);
	test_u_fn(41943033uL);
	test_u_fn(41943034uL);
	test_u_fn(83886070uL);
	test_u_fn(83886071uL);
	test_u_fv(83886072uL, 0x4c9fffff);
	test_u_fn(83886073uL);
	test_u_fn(83886074uL);
	test_u_fn(167772150uL);
	test_u_fn(167772151uL);
	test_u_fn(167772152uL);
	test_u_fn(167772153uL);
	test_u_fn(167772154uL);
	test_u_fn(335544310uL);
	test_u_fn(335544311uL);
	test_u_fn(335544312uL);
	test_u_fn(335544313uL);
	test_u_fn(335544314uL);
	test_u_fn(671088630uL);
	test_u_fn(671088634uL);
	test_u_fn(1342177270uL);
	test_u_fn(1342177274uL);
	test_u_fn(2684354550uL);
	test_u_fn(2684354554uL);
	test_u_fn(5368709110uL);
	test_u_fn(5368709114uL);
	test_u_fn(10737418230uL);
	test_u_fn(10737418234uL);
	test_u_fn(21474836470uL);
	test_u_fn(21474836474uL);
	test_u_fn(42949672950uL);
	test_u_fn(42949672954uL);
	test_u_fn(85899345910uL);
	test_u_fn(85899345914uL);
	test_u_fn(171798691830uL);
	test_u_fn(171798691834uL);
	test_u_fn(343597383670uL);
	test_u_fn(343597383674uL);
	test_u_fn(687194767350uL);
	test_u_fn(687194767354uL);
	test_u_fn(1374389534710uL);
	test_u_fn(1374389534714uL);
	test_u_fn(2748779069430uL);
	test_u_fn(2748779069434uL);
	test_u_fn(5497558138870uL);
	test_u_fn(5497558138874uL);
	test_u_fn(10995116277750uL);
	test_u_fn(10995116277754uL);
	test_u_fn(21990232555510uL);
	test_u_fn(21990232555514uL);
	test_u_fn(43980465111030uL);
	test_u_fn(43980465111034uL);
	test_u_fn(87960930222070uL);
	test_u_fn(87960930222074uL);
	test_u_fn(175921860444150uL);
	test_u_fn(175921860444154uL);
	test_u_fn(351843720888310uL);
	test_u_fn(351843720888314uL);
	test_u_fn(703687441776630uL);
	test_u_fn(703687441776634uL);
	test_u_fn(1407374883553270uL);
	test_u_fn(1407374883553274uL);
	test_u_fn(2814749767106550uL);
	test_u_fn(2814749767106554uL);
	test_u_fn(5629499534213110uL);
	test_u_fn(5629499534213114uL);
	test_u_fn(11258999068426230uL);
	test_u_fn(11258999068426234uL);
	test_u_fn(22517998136852470uL);
	test_u_fn(22517998136852474uL);
	test_u_fn(45035996273704950uL);
	test_u_fn(45035996273704954uL);
	test_u_fn(90071992547409910uL);
	test_u_fn(90071992547409914uL);
	test_u_fn(180143985094819830uL);
	test_u_fn(180143985094819834uL);
	test_u_fn(360287970189639670uL);
	test_u_fn(360287970189639674uL);
	test_u_fn(720575940379279350uL);
	test_u_fn(720575940379279354uL);
	test_u_fn(1441151880758558710uL);
	test_u_fn(1441151880758558714uL);
	test_u_fn(2882303761517117430uL);
	test_u_fn(2882303761517117434uL);
	test_u_fn(5764607523034234870uL);
	test_u_fn(5764607523034234874uL);
	test_u_fn(11529215046068469750uL);
	test_u_fn(11529215046068469754uL);
	test_u_fn(4611686018427387894uL);
	test_u_fn(4611686018427387898uL);
	test_u_fn(9223372036854775798uL);
	test_u_fn(9223372036854775802uL);
	test_u_fn(18446744073709551606uL);
	test_u_fn(18446744073709551610uL);

	test_u_fv(1073741824uL, 0x4e800000);
	test_u_fv(2147483648uL, 0x4f000000);
	test_u_fv(3221225472uL, 0x4f400000);
	test_u_fv(4294967296uL, 0x4f800000);
	test_u_fv(10737418240uL, 0x50200000);
	test_u_fv(11811160064uL, 0x50300000);
	test_u_fv(12884901888uL, 0x50400000);
	test_u_fv(13958643712uL, 0x50500000);
	test_u_fv(15032385536uL, 0x50600000);
	test_u_fv(32212254720uL, 0x50f00000);
	test_u_fv(33285996544uL, 0x50f80000);
	test_u_fv(34359738368uL, 0x51000000);
	test_u_fv(35433480192uL, 0x51040000);
	test_u_fv(36507222016uL, 0x51080000);
	test_u_fv(75161927680uL, 0x518c0000);
	test_u_fv(76235669504uL, 0x518e0000);
	test_u_fv(77309411328uL, 0x51900000);
	test_u_fv(78383153152uL, 0x51920000);
	test_u_fv(79456894976uL, 0x51940000);
	test_u_fv(161061273600uL, 0x52160000);
	test_u_fv(162135015424uL, 0x52170000);
	test_u_fv(163208757248uL, 0x52180000);
	test_u_fv(164282499072uL, 0x52190000);
	test_u_fv(165356240896uL, 0x521a0000);
	test_u_fv(332859965440uL, 0x529b0000);
	test_u_fv(333933707264uL, 0x529b8000);
	test_u_fv(335007449088uL, 0x529c0000);
	test_u_fv(336081190912uL, 0x529c8000);
	test_u_fv(337154932736uL, 0x529d0000);
	test_u_fv(676457349120uL, 0x531d8000);
	test_u_fv(677531090944uL, 0x531dc000);
	test_u_fv(678604832768uL, 0x531e0000);
	test_u_fv(679678574592uL, 0x531e4000);
	test_u_fv(680752316416uL, 0x531e8000);
	test_u_fv(1363652116480uL, 0x539ec000);
	test_u_fv(1364725858304uL, 0x539ee000);
	test_u_fv(1365799600128uL, 0x539f0000);
	test_u_fv(1366873341952uL, 0x539f2000);
	test_u_fv(1367947083776uL, 0x539f4000);
	test_u_fv(2738041651200uL, 0x541f6000);
	test_u_fv(2739115393024uL, 0x541f7000);
	test_u_fv(2740189134848uL, 0x541f8000);
	test_u_fv(2741262876672uL, 0x541f9000);
	test_u_fv(2742336618496uL, 0x541fa000);
	test_u_fv(5486820720640uL, 0x549fb000);
	test_u_fv(5487894462464uL, 0x549fb800);
	test_u_fv(5488968204288uL, 0x549fc000);
	test_u_fv(5490041946112uL, 0x549fc800);
	test_u_fv(5491115687936uL, 0x549fd000);
	test_u_fv(10984378859520uL, 0x551fd800);
	test_u_fv(10985452601344uL, 0x551fdc00);
	test_u_fv(10986526343168uL, 0x551fe000);
	test_u_fv(10987600084992uL, 0x551fe400);
	test_u_fv(10988673826816uL, 0x551fe800);
	test_u_fv(21979495137280uL, 0x559fec00);
	test_u_fv(21980568879104uL, 0x559fee00);
	test_u_fv(21981642620928uL, 0x559ff000);
	test_u_fv(21982716362752uL, 0x559ff200);
	test_u_fv(21983790104576uL, 0x559ff400);
	test_u_fv(43969727692800uL, 0x561ff600);
	test_u_fv(43970801434624uL, 0x561ff700);
	test_u_fv(43971875176448uL, 0x561ff800);
	test_u_fv(43972948918272uL, 0x561ff900);
	test_u_fv(43974022660096uL, 0x561ffa00);
	test_u_fv(87950192803840uL, 0x569ffb00);
	test_u_fv(87951266545664uL, 0x569ffb80);
	test_u_fv(87952340287488uL, 0x569ffc00);
	test_u_fv(87953414029312uL, 0x569ffc80);
	test_u_fv(87954487771136uL, 0x569ffd00);
	test_u_fv(175911123025920uL, 0x571ffd80);
	test_u_fv(175912196767744uL, 0x571ffdc0);
	test_u_fv(175913270509568uL, 0x571ffe00);
	test_u_fv(175914344251392uL, 0x571ffe40);
	test_u_fv(175915417993216uL, 0x571ffe80);
	test_u_fv(351832983470080uL, 0x579ffec0);
	test_u_fv(351834057211904uL, 0x579ffee0);
	test_u_fv(351835130953728uL, 0x579fff00);
	test_u_fv(351836204695552uL, 0x579fff20);
	test_u_fv(351837278437376uL, 0x579fff40);
	test_u_fv(703676704358400uL, 0x581fff60);
	test_u_fv(703677778100224uL, 0x581fff70);
	test_u_fv(703678851842048uL, 0x581fff80);
	test_u_fv(703679925583872uL, 0x581fff90);
	test_u_fv(703680999325696uL, 0x581fffa0);
	test_u_fv(1407364146135040uL, 0x589fffb0);
	test_u_fv(1407365219876864uL, 0x589fffb8);
	test_u_fv(1407366293618688uL, 0x589fffc0);
	test_u_fv(1407367367360512uL, 0x589fffc8);
	test_u_fv(1407368441102336uL, 0x589fffd0);
	test_u_fv(2814739029688320uL, 0x591fffd8);
	test_u_fv(2814740103430144uL, 0x591fffdc);
	test_u_fv(2814741177171968uL, 0x591fffe0);
	test_u_fv(2814742250913792uL, 0x591fffe4);
	test_u_fv(2814743324655616uL, 0x591fffe8);
	test_u_fv(5629488796794880uL, 0x599fffec);
	test_u_fv(5629489870536704uL, 0x599fffee);
	test_u_fv(5629490944278528uL, 0x599ffff0);
	test_u_fv(5629492018020352uL, 0x599ffff2);
	test_u_fv(5629493091762176uL, 0x599ffff4);
	test_u_fv(11258988331008000uL, 0x5a1ffff6);
	test_u_fv(11258989404749824uL, 0x5a1ffff7);
	test_u_fv(11258990478491648uL, 0x5a1ffff8);
	test_u_fv(11258991552233472uL, 0x5a1ffff9);
	test_u_fv(11258992625975296uL, 0x5a1ffffa);
	test_u_fv(22517987399434240uL, 0x5a9ffffb);
	test_u_fn(22517988473176064uL);
	test_u_fv(22517989546917888uL, 0x5a9ffffc);
	test_u_fn(22517990620659712uL);
	test_u_fv(22517991694401536uL, 0x5a9ffffd);
	test_u_fn(45035985536286720uL);
	test_u_fn(45035986610028544uL);
	test_u_fv(45035987683770368uL, 0x5b1ffffe);
	test_u_fn(45035988757512192uL);
	test_u_fn(45035989831254016uL);
	test_u_fn(90071981809991680uL);
	test_u_fn(90071982883733504uL);
	test_u_fv(90071983957475328uL, 0x5b9fffff);
	test_u_fn(90071985031217152uL);

	test_u_fv(18446733078593273856uL, 0x5f7ffff6);
	test_u_fv(18446734178104901632uL, 0x5f7ffff7);
	test_u_fv(18446735277616529408uL, 0x5f7ffff8);
	test_u_fv(18446736377128157184uL, 0x5f7ffff9);
	test_u_fv(18446737476639784960uL, 0x5f7ffffa);
	test_u_fv(18446733078593273856uL, 0x5f7ffff6);
	test_u_fv(18446734178104901632uL, 0x5f7ffff7);
}

def test_l_dn(i: long) {  // long -> double, expecting null
	var v = tryPromoteS_F64(i);
	if (v != null) {
		var got = Float64Val.!(v).bits;
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected null, got ", i);
		buf.putd(long.!(got));
		TEST.error(buf.toString());
	}
}
def test_l_dv(i: long, expected: u64) { // long -> double, expecting value
	var v = tryPromoteS_F64(i);
	if (v == null) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(long.!(expected));
		buf.puts(", got null");
		TEST.error(buf.toString());
		return;
	}
	var got = Float64Val.!(v).bits;
	if (expected != got) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(long.!(expected));
		buf.puts(", got ");
		buf.putx(long.!(got));
		TEST.error(buf.toString());
		return;
	}
}

def test_u_dn(i: u64) {  // long -> double, expecting null
	var v = tryPromoteU_F64(i);
	if (v != null) {
		var got = Float64Val.!(v).bits;
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected null, got ", i);
		buf.putx(long.!(got));
		TEST.error(buf.toString());
	}
}
def test_u_dv(i: u64, expected: u64) { // long -> float, expecting value
	var v = tryPromoteU_F64(i);
	if (v == null) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(long.!(expected));
		buf.puts(", got null");
		TEST.error(buf.toString());
		return;
	}
	var got = Float64Val.!(v).bits;
	if (expected != got) {
		var buf = StringBuilder.new();
		buf.put1("cast(%d) expected f32:", i);
		buf.putx(long.!(expected));
		buf.puts(", got ");
		buf.putx(long.!(got));
		TEST.error(buf.toString());
		return;
	}
}

def test_f64s() {
	test_l_dv(0, 0x0);
	test_l_dv(-1, 0xbff0000000000000);
	test_l_dv(-2, 0xc000000000000000);
	test_l_dv(-6, 0xc018000000000000);
	test_l_dv(-7, 0xc01c000000000000);
	test_l_dv(-8, 0xc020000000000000);
	test_l_dv(-18, 0xc032000000000000);
	test_l_dv(-19, 0xc033000000000000);
	test_l_dv(-20, 0xc034000000000000);
	test_l_dv(-42, 0xc045000000000000);
	test_l_dv(-43, 0xc045800000000000);
	test_l_dv(-44, 0xc046000000000000);
	test_l_dv(-90, 0xc056800000000000);
	test_l_dv(-91, 0xc056c00000000000);
	test_l_dv(-92, 0xc057000000000000);
	test_l_dv(-186, 0xc067400000000000);
	test_l_dv(-187, 0xc067600000000000);
	test_l_dv(-188, 0xc067800000000000);
	test_l_dv(-378, 0xc077a00000000000);
	test_l_dv(-379, 0xc077b00000000000);
	test_l_dv(-380, 0xc077c00000000000);
	test_l_dv(-762, 0xc087d00000000000);
	test_l_dv(-763, 0xc087d80000000000);
	test_l_dv(-764, 0xc087e00000000000);
	test_l_dv(-1530, 0xc097e80000000000);
	test_l_dv(-1531, 0xc097ec0000000000);
	test_l_dv(-1532, 0xc097f00000000000);
	test_l_dv(-3066, 0xc0a7f40000000000);
	test_l_dv(-3067, 0xc0a7f60000000000);
	test_l_dv(-3068, 0xc0a7f80000000000);
	test_l_dv(-6138, 0xc0b7fa0000000000);
	test_l_dv(-6139, 0xc0b7fb0000000000);
	test_l_dv(-6140, 0xc0b7fc0000000000);
	test_l_dv(-12282, 0xc0c7fd0000000000);
	test_l_dv(-12283, 0xc0c7fd8000000000);
	test_l_dv(-12284, 0xc0c7fe0000000000);
	test_l_dv(-24570, 0xc0d7fe8000000000);
	test_l_dv(-24571, 0xc0d7fec000000000);
	test_l_dv(-24572, 0xc0d7ff0000000000);
	test_l_dv(-49146, 0xc0e7ff4000000000);
	test_l_dv(-49147, 0xc0e7ff6000000000);
	test_l_dv(-49148, 0xc0e7ff8000000000);
	test_l_dv(-98298, 0xc0f7ffa000000000);
	test_l_dv(-98299, 0xc0f7ffb000000000);
	test_l_dv(-98300, 0xc0f7ffc000000000);
	test_l_dv(-196602, 0xc107ffd000000000);
	test_l_dv(-196603, 0xc107ffd800000000);
	test_l_dv(-196604, 0xc107ffe000000000);
	test_l_dv(-393210, 0xc117ffe800000000);
	test_l_dv(-393211, 0xc117ffec00000000);
	test_l_dv(-393212, 0xc117fff000000000);
	test_l_dv(-786426, 0xc127fff400000000);
	test_l_dv(-786427, 0xc127fff600000000);
	test_l_dv(-786428, 0xc127fff800000000);
	test_l_dv(-1572858, 0xc137fffa00000000);
	test_l_dv(-1572859, 0xc137fffb00000000);
	test_l_dv(-1572860, 0xc137fffc00000000);
	test_l_dv(-3145722, 0xc147fffd00000000);
	test_l_dv(-3145723, 0xc147fffd80000000);
	test_l_dv(-3145724, 0xc147fffe00000000);
	test_l_dv(-6291450, 0xc157fffe80000000);
	test_l_dv(-6291451, 0xc157fffec0000000);
	test_l_dv(-6291452, 0xc157ffff00000000);
	test_l_dv(-12582906, 0xc167ffff40000000);
	test_l_dv(-12582907, 0xc167ffff60000000);
	test_l_dv(-12582908, 0xc167ffff80000000);
	test_l_dv(-25165818, 0xc177ffffa0000000);
	test_l_dv(-25165819, 0xc177ffffb0000000);
	test_l_dv(-25165820, 0xc177ffffc0000000);
	test_l_dv(-50331642, 0xc187ffffd0000000);
	test_l_dv(-50331643, 0xc187ffffd8000000);
	test_l_dv(-50331644, 0xc187ffffe0000000);
	test_l_dv(-100663290, 0xc197ffffe8000000);
	test_l_dv(-100663291, 0xc197ffffec000000);
	test_l_dv(-100663292, 0xc197fffff0000000);
	test_l_dv(-201326586, 0xc1a7fffff4000000);
	test_l_dv(-201326587, 0xc1a7fffff6000000);
	test_l_dv(-201326588, 0xc1a7fffff8000000);
	test_l_dv(-402653178, 0xc1b7fffffa000000);
	test_l_dv(-402653179, 0xc1b7fffffb000000);
	test_l_dv(-402653180, 0xc1b7fffffc000000);
	test_l_dv(-805306362, 0xc1c7fffffd000000);
	test_l_dv(-805306363, 0xc1c7fffffd800000);
	test_l_dv(-805306364, 0xc1c7fffffe000000);
	test_l_dv(-1610612730, 0xc1d7fffffe800000);
	test_l_dv(-1610612731, 0xc1d7fffffec00000);
	test_l_dv(-1610612732, 0xc1d7ffffff000000);
	test_l_dv(-3221225466, 0xc1e7ffffff400000);
	test_l_dv(-3221225467, 0xc1e7ffffff600000);
	test_l_dv(-3221225468, 0xc1e7ffffff800000);
	test_l_dv(-6442450938, 0xc1f7ffffffa00000);
	test_l_dv(-6442450939, 0xc1f7ffffffb00000);
	test_l_dv(-6442450940, 0xc1f7ffffffc00000);
	test_l_dv(-12884901882, 0xc207ffffffd00000);
	test_l_dv(-12884901883, 0xc207ffffffd80000);
	test_l_dv(-12884901884, 0xc207ffffffe00000);
	test_l_dv(-25769803770, 0xc217ffffffe80000);
	test_l_dv(-25769803771, 0xc217ffffffec0000);
	test_l_dv(-25769803772, 0xc217fffffff00000);
	test_l_dv(-51539607546, 0xc227fffffff40000);
	test_l_dv(-51539607547, 0xc227fffffff60000);
	test_l_dv(-51539607548, 0xc227fffffff80000);
	test_l_dv(-103079215098, 0xc237fffffffa0000);
	test_l_dv(-103079215099, 0xc237fffffffb0000);
	test_l_dv(-103079215100, 0xc237fffffffc0000);
	test_l_dv(-206158430202, 0xc247fffffffd0000);
	test_l_dv(-206158430203, 0xc247fffffffd8000);
	test_l_dv(-206158430204, 0xc247fffffffe0000);
	test_l_dv(-412316860410, 0xc257fffffffe8000);
	test_l_dv(-412316860411, 0xc257fffffffec000);
	test_l_dv(-412316860412, 0xc257ffffffff0000);
	test_l_dv(-824633720826, 0xc267ffffffff4000);
	test_l_dv(-824633720827, 0xc267ffffffff6000);
	test_l_dv(-824633720828, 0xc267ffffffff8000);
	test_l_dv(-1649267441658, 0xc277ffffffffa000);
	test_l_dv(-1649267441659, 0xc277ffffffffb000);
	test_l_dv(-1649267441660, 0xc277ffffffffc000);
	test_l_dv(-3298534883322, 0xc287ffffffffd000);
	test_l_dv(-3298534883323, 0xc287ffffffffd800);
	test_l_dv(-3298534883324, 0xc287ffffffffe000);
	test_l_dv(-6597069766650, 0xc297ffffffffe800);
	test_l_dv(-6597069766651, 0xc297ffffffffec00);
	test_l_dv(-6597069766652, 0xc297fffffffff000);
	test_l_dv(-13194139533306, 0xc2a7fffffffff400);
	test_l_dv(-13194139533307, 0xc2a7fffffffff600);
	test_l_dv(-13194139533308, 0xc2a7fffffffff800);
	test_l_dv(-26388279066618, 0xc2b7fffffffffa00);
	test_l_dv(-26388279066619, 0xc2b7fffffffffb00);
	test_l_dv(-26388279066620, 0xc2b7fffffffffc00);
	test_l_dv(-52776558133242, 0xc2c7fffffffffd00);
	test_l_dv(-52776558133243, 0xc2c7fffffffffd80);
	test_l_dv(-52776558133244, 0xc2c7fffffffffe00);
	test_l_dv(-105553116266490, 0xc2d7fffffffffe80);
	test_l_dv(-105553116266491, 0xc2d7fffffffffec0);
	test_l_dv(-105553116266492, 0xc2d7ffffffffff00);
	test_l_dv(-211106232532986, 0xc2e7ffffffffff40);
	test_l_dv(-211106232532987, 0xc2e7ffffffffff60);
	test_l_dv(-211106232532988, 0xc2e7ffffffffff80);
	test_l_dv(-422212465065978, 0xc2f7ffffffffffa0);
	test_l_dv(-422212465065979, 0xc2f7ffffffffffb0);
	test_l_dv(-422212465065980, 0xc2f7ffffffffffc0);
	test_l_dv(-844424930131962, 0xc307ffffffffffd0);
	test_l_dv(-844424930131963, 0xc307ffffffffffd8);
	test_l_dv(-844424930131964, 0xc307ffffffffffe0);
	test_l_dv(-1688849860263930, 0xc317ffffffffffe8);
	test_l_dv(-1688849860263931, 0xc317ffffffffffec);
	test_l_dv(-1688849860263932, 0xc317fffffffffff0);
	test_l_dv(-3377699720527866, 0xc327fffffffffff4);
	test_l_dv(-3377699720527867, 0xc327fffffffffff6);
	test_l_dv(-3377699720527868, 0xc327fffffffffff8);
	test_l_dv(-6755399441055738, 0xc337fffffffffffa);
	test_l_dv(-6755399441055739, 0xc337fffffffffffb);
	test_l_dv(-6755399441055740, 0xc337fffffffffffc);
	test_l_dv(-13510798882111482, 0xc347fffffffffffd);
	test_l_dn(-13510798882111483);
	test_l_dv(-13510798882111484, 0xc347fffffffffffe);
	test_l_dn(-27021597764222970);
	test_l_dn(-27021597764222971);
	test_l_dv(-27021597764222972, 0xc357ffffffffffff);
	test_l_dn(-54043195528445946);
	test_l_dn(-54043195528445947);
	test_l_dn(-54043195528445948);
	test_l_dn(-108086391056891898);
	test_l_dn(-108086391056891899);
	test_l_dn(-108086391056891900);
	test_l_dn(-216172782113783802);
	test_l_dn(-216172782113783803);
	test_l_dn(-216172782113783804);
	test_l_dn(-432345564227567610);
	test_l_dn(-432345564227567611);
	test_l_dn(-432345564227567612);
	test_l_dn(-864691128455135226);
	test_l_dn(-864691128455135227);
	test_l_dn(-864691128455135228);
	test_l_dn(-1729382256910270458);
	test_l_dn(-1729382256910270459);
	test_l_dn(-1729382256910270460);
	test_l_dn(-3458764513820540922);
	test_l_dn(-3458764513820540923);
	test_l_dn(-3458764513820540924);
	test_l_dn(-6917529027641081850);
	test_l_dn(-6917529027641081851);
	test_l_dn(-6917529027641081852);
	test_l_dn(4611686018427387910);
	test_l_dn(4611686018427387909);
	test_l_dn(4611686018427387908);
	test_l_dn(-9223372036854775802);
	test_l_dn(-9223372036854775803);
	test_l_dn(-9223372036854775804);
	test_l_dv(6, 0x4018000000000000);
	test_l_dv(5, 0x4014000000000000);
	test_l_dv(4, 0x4010000000000000);

	test_l_dv(-108086391056886784, 0xc377fffffffffec0);
	test_l_dv(-108086391056887808, 0xc377ffffffffff00);
	test_l_dv(-216172782113777664, 0xc387ffffffffff40);
	test_l_dv(-216172782113778688, 0xc387ffffffffff60);
	test_l_dv(-216172782113779712, 0xc387ffffffffff80);
	test_l_dv(-432345564227561472, 0xc397ffffffffffa0);
	test_l_dv(-432345564227562496, 0xc397ffffffffffb0);
	test_l_dv(-432345564227563520, 0xc397ffffffffffc0);
	test_l_dv(-864691128455129088, 0xc3a7ffffffffffd0);
	test_l_dv(-864691128455130112, 0xc3a7ffffffffffd8);
	test_l_dv(-864691128455131136, 0xc3a7ffffffffffe0);
	test_l_dv(-1729382256910264320, 0xc3b7ffffffffffe8);
	test_l_dv(-1729382256910265344, 0xc3b7ffffffffffec);
	test_l_dv(-1729382256910266368, 0xc3b7fffffffffff0);
	test_l_dv(-3458764513820534784, 0xc3c7fffffffffff4);
	test_l_dv(-3458764513820535808, 0xc3c7fffffffffff6);
	test_l_dv(-3458764513820536832, 0xc3c7fffffffffff8);
	test_l_dv(-6917529027641075712, 0xc3d7fffffffffffa);
	test_l_dv(-6917529027641076736, 0xc3d7fffffffffffb);
	test_l_dv(-6917529027641077760, 0xc3d7fffffffffffc);
	test_l_dv(4611686018427394048, 0x43d0000000000006);
	test_l_dv(4611686018427393024, 0x43d0000000000005);
	test_l_dv(4611686018427392000, 0x43d0000000000004);
	test_l_dv(-9223372036854769664, 0xc3dffffffffffffa);
	test_l_dv(-9223372036854770688, 0xc3dffffffffffffb);
	test_l_dv(-9223372036854771712, 0xc3dffffffffffffc);
}

def test_f64u() {
	test_u_dv(0uL, 0x0);
	test_u_dv(1uL, 0x3ff0000000000000);
	test_u_dv(2uL, 0x4000000000000000);
	test_u_dv(6uL, 0x4018000000000000);
	test_u_dv(7uL, 0x401c000000000000);
	test_u_dv(8uL, 0x4020000000000000);
	test_u_dv(18uL, 0x4032000000000000);
	test_u_dv(19uL, 0x4033000000000000);
	test_u_dv(20uL, 0x4034000000000000);
	test_u_dv(42uL, 0x4045000000000000);
	test_u_dv(43uL, 0x4045800000000000);
	test_u_dv(44uL, 0x4046000000000000);
	test_u_dv(90uL, 0x4056800000000000);
	test_u_dv(91uL, 0x4056c00000000000);
	test_u_dv(92uL, 0x4057000000000000);
	test_u_dv(186uL, 0x4067400000000000);
	test_u_dv(187uL, 0x4067600000000000);
	test_u_dv(188uL, 0x4067800000000000);
	test_u_dv(378uL, 0x4077a00000000000);
	test_u_dv(379uL, 0x4077b00000000000);
	test_u_dv(380uL, 0x4077c00000000000);
	test_u_dv(762uL, 0x4087d00000000000);
	test_u_dv(763uL, 0x4087d80000000000);
	test_u_dv(764uL, 0x4087e00000000000);
	test_u_dv(1530uL, 0x4097e80000000000);
	test_u_dv(1531uL, 0x4097ec0000000000);
	test_u_dv(1532uL, 0x4097f00000000000);
	test_u_dv(3066uL, 0x40a7f40000000000);
	test_u_dv(3067uL, 0x40a7f60000000000);
	test_u_dv(3068uL, 0x40a7f80000000000);
	test_u_dv(6138uL, 0x40b7fa0000000000);
	test_u_dv(6139uL, 0x40b7fb0000000000);
	test_u_dv(6140uL, 0x40b7fc0000000000);
	test_u_dv(12282uL, 0x40c7fd0000000000);
	test_u_dv(12283uL, 0x40c7fd8000000000);
	test_u_dv(12284uL, 0x40c7fe0000000000);
	test_u_dv(24570uL, 0x40d7fe8000000000);
	test_u_dv(24571uL, 0x40d7fec000000000);
	test_u_dv(24572uL, 0x40d7ff0000000000);
	test_u_dv(49146uL, 0x40e7ff4000000000);
	test_u_dv(49147uL, 0x40e7ff6000000000);
	test_u_dv(49148uL, 0x40e7ff8000000000);
	test_u_dv(98298uL, 0x40f7ffa000000000);
	test_u_dv(98299uL, 0x40f7ffb000000000);
	test_u_dv(98300uL, 0x40f7ffc000000000);
	test_u_dv(196602uL, 0x4107ffd000000000);
	test_u_dv(196603uL, 0x4107ffd800000000);
	test_u_dv(196604uL, 0x4107ffe000000000);
	test_u_dv(393210uL, 0x4117ffe800000000);
	test_u_dv(393211uL, 0x4117ffec00000000);
	test_u_dv(393212uL, 0x4117fff000000000);
	test_u_dv(786426uL, 0x4127fff400000000);
	test_u_dv(786427uL, 0x4127fff600000000);
	test_u_dv(786428uL, 0x4127fff800000000);
	test_u_dv(1572858uL, 0x4137fffa00000000);
	test_u_dv(1572859uL, 0x4137fffb00000000);
	test_u_dv(1572860uL, 0x4137fffc00000000);
	test_u_dv(3145722uL, 0x4147fffd00000000);
	test_u_dv(3145723uL, 0x4147fffd80000000);
	test_u_dv(3145724uL, 0x4147fffe00000000);
	test_u_dv(6291450uL, 0x4157fffe80000000);
	test_u_dv(6291451uL, 0x4157fffec0000000);
	test_u_dv(6291452uL, 0x4157ffff00000000);
	test_u_dv(12582906uL, 0x4167ffff40000000);
	test_u_dv(12582907uL, 0x4167ffff60000000);
	test_u_dv(12582908uL, 0x4167ffff80000000);
	test_u_dv(25165818uL, 0x4177ffffa0000000);
	test_u_dv(25165819uL, 0x4177ffffb0000000);
	test_u_dv(25165820uL, 0x4177ffffc0000000);
	test_u_dv(50331642uL, 0x4187ffffd0000000);
	test_u_dv(50331643uL, 0x4187ffffd8000000);
	test_u_dv(50331644uL, 0x4187ffffe0000000);
	test_u_dv(100663290uL, 0x4197ffffe8000000);
	test_u_dv(100663291uL, 0x4197ffffec000000);
	test_u_dv(100663292uL, 0x4197fffff0000000);
	test_u_dv(201326586uL, 0x41a7fffff4000000);
	test_u_dv(201326587uL, 0x41a7fffff6000000);
	test_u_dv(201326588uL, 0x41a7fffff8000000);
	test_u_dv(402653178uL, 0x41b7fffffa000000);
	test_u_dv(402653179uL, 0x41b7fffffb000000);
	test_u_dv(402653180uL, 0x41b7fffffc000000);
	test_u_dv(805306362uL, 0x41c7fffffd000000);
	test_u_dv(805306363uL, 0x41c7fffffd800000);
	test_u_dv(805306364uL, 0x41c7fffffe000000);
	test_u_dv(1610612730uL, 0x41d7fffffe800000);
	test_u_dv(1610612731uL, 0x41d7fffffec00000);
	test_u_dv(1610612732uL, 0x41d7ffffff000000);
	test_u_dv(3221225466uL, 0x41e7ffffff400000);
	test_u_dv(3221225467uL, 0x41e7ffffff600000);
	test_u_dv(3221225468uL, 0x41e7ffffff800000);
	test_u_dv(6442450938uL, 0x41f7ffffffa00000);
	test_u_dv(6442450939uL, 0x41f7ffffffb00000);
	test_u_dv(6442450940uL, 0x41f7ffffffc00000);
	test_u_dv(12884901882uL, 0x4207ffffffd00000);
	test_u_dv(12884901883uL, 0x4207ffffffd80000);
	test_u_dv(12884901884uL, 0x4207ffffffe00000);
	test_u_dv(25769803770uL, 0x4217ffffffe80000);
	test_u_dv(25769803771uL, 0x4217ffffffec0000);
	test_u_dv(25769803772uL, 0x4217fffffff00000);
	test_u_dv(51539607546uL, 0x4227fffffff40000);
	test_u_dv(51539607547uL, 0x4227fffffff60000);
	test_u_dv(51539607548uL, 0x4227fffffff80000);
	test_u_dv(103079215098uL, 0x4237fffffffa0000);
	test_u_dv(103079215099uL, 0x4237fffffffb0000);
	test_u_dv(103079215100uL, 0x4237fffffffc0000);
	test_u_dv(206158430202uL, 0x4247fffffffd0000);
	test_u_dv(206158430203uL, 0x4247fffffffd8000);
	test_u_dv(206158430204uL, 0x4247fffffffe0000);
	test_u_dv(412316860410uL, 0x4257fffffffe8000);
	test_u_dv(412316860411uL, 0x4257fffffffec000);
	test_u_dv(412316860412uL, 0x4257ffffffff0000);
	test_u_dv(824633720826uL, 0x4267ffffffff4000);
	test_u_dv(824633720827uL, 0x4267ffffffff6000);
	test_u_dv(824633720828uL, 0x4267ffffffff8000);
	test_u_dv(1649267441658uL, 0x4277ffffffffa000);
	test_u_dv(1649267441659uL, 0x4277ffffffffb000);
	test_u_dv(1649267441660uL, 0x4277ffffffffc000);
	test_u_dv(3298534883322uL, 0x4287ffffffffd000);
	test_u_dv(3298534883323uL, 0x4287ffffffffd800);
	test_u_dv(3298534883324uL, 0x4287ffffffffe000);
	test_u_dv(6597069766650uL, 0x4297ffffffffe800);
	test_u_dv(6597069766651uL, 0x4297ffffffffec00);
	test_u_dv(6597069766652uL, 0x4297fffffffff000);
	test_u_dv(13194139533306uL, 0x42a7fffffffff400);
	test_u_dv(13194139533307uL, 0x42a7fffffffff600);
	test_u_dv(13194139533308uL, 0x42a7fffffffff800);
	test_u_dv(26388279066618uL, 0x42b7fffffffffa00);
	test_u_dv(26388279066619uL, 0x42b7fffffffffb00);
	test_u_dv(26388279066620uL, 0x42b7fffffffffc00);
	test_u_dv(52776558133242uL, 0x42c7fffffffffd00);
	test_u_dv(52776558133243uL, 0x42c7fffffffffd80);
	test_u_dv(52776558133244uL, 0x42c7fffffffffe00);
	test_u_dv(105553116266490uL, 0x42d7fffffffffe80);
	test_u_dv(105553116266491uL, 0x42d7fffffffffec0);
	test_u_dv(105553116266492uL, 0x42d7ffffffffff00);
	test_u_dv(211106232532986uL, 0x42e7ffffffffff40);
	test_u_dv(211106232532987uL, 0x42e7ffffffffff60);
	test_u_dv(211106232532988uL, 0x42e7ffffffffff80);
	test_u_dv(422212465065978uL, 0x42f7ffffffffffa0);
	test_u_dv(422212465065979uL, 0x42f7ffffffffffb0);
	test_u_dv(422212465065980uL, 0x42f7ffffffffffc0);
	test_u_dv(844424930131962uL, 0x4307ffffffffffd0);
	test_u_dv(844424930131963uL, 0x4307ffffffffffd8);
	test_u_dv(844424930131964uL, 0x4307ffffffffffe0);
	test_u_dv(1688849860263930uL, 0x4317ffffffffffe8);
	test_u_dv(1688849860263931uL, 0x4317ffffffffffec);
	test_u_dv(1688849860263932uL, 0x4317fffffffffff0);
	test_u_dv(3377699720527866uL, 0x4327fffffffffff4);
	test_u_dv(3377699720527867uL, 0x4327fffffffffff6);
	test_u_dv(3377699720527868uL, 0x4327fffffffffff8);
	test_u_dv(6755399441055738uL, 0x4337fffffffffffa);
	test_u_dv(6755399441055739uL, 0x4337fffffffffffb);
	test_u_dv(6755399441055740uL, 0x4337fffffffffffc);
	test_u_dv(13510798882111482uL, 0x4347fffffffffffd);
	test_u_dn(13510798882111483uL);
	test_u_dv(13510798882111484uL, 0x4347fffffffffffe);
	test_u_dn(27021597764222970uL);
	test_u_dn(27021597764222971uL);
	test_u_dv(27021597764222972uL, 0x4357ffffffffffff);
	test_u_dn(54043195528445946uL);
	test_u_dn(54043195528445947uL);
	test_u_dn(54043195528445948uL);
	test_u_dn(108086391056891898uL);
	test_u_dn(108086391056891899uL);
	test_u_dn(108086391056891900uL);
	test_u_dn(216172782113783802uL);
	test_u_dn(216172782113783803uL);
	test_u_dn(216172782113783804uL);
	test_u_dn(432345564227567610uL);
	test_u_dn(432345564227567611uL);
	test_u_dn(432345564227567612uL);
	test_u_dn(864691128455135226uL);
	test_u_dn(864691128455135227uL);
	test_u_dn(864691128455135228uL);
	test_u_dn(1729382256910270458uL);
	test_u_dn(1729382256910270459uL);
	test_u_dn(1729382256910270460uL);
	test_u_dn(3458764513820540922uL);
	test_u_dn(3458764513820540923uL);
	test_u_dn(3458764513820540924uL);
	test_u_dn(6917529027641081850uL);
	test_u_dn(6917529027641081851uL);
	test_u_dn(6917529027641081852uL);
	test_u_dn(13835058055282163706uL);
	test_u_dn(13835058055282163707uL);
	test_u_dn(13835058055282163708uL);
	test_u_dn(9223372036854775802uL);
	test_u_dn(9223372036854775803uL);
	test_u_dn(9223372036854775804uL);
	test_u_dn(18446744073709551610uL);
	test_u_dn(18446744073709551611uL);
	test_u_dn(18446744073709551612uL);

	test_u_dv(6917529027641076736uL, 0x43d7fffffffffffb);
	test_u_dv(6917529027641077760uL, 0x43d7fffffffffffc);
	test_u_dv(13835058055282157568uL, 0x43e7fffffffffffd);
	test_u_dn(13835058055282158592uL);
	test_u_dv(13835058055282159616uL, 0x43e7fffffffffffe);
	test_u_dv(9223372036854769664uL, 0x43dffffffffffffa);
	test_u_dv(9223372036854770688uL, 0x43dffffffffffffb);
	test_u_dv(9223372036854771712uL, 0x43dffffffffffffc);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
	test_u_dv(18446744073709545472uL, 0x43effffffffffffd);
	test_u_dn(18446744073709546496uL);
	test_u_dv(18446744073709547520uL, 0x43effffffffffffe);
}

